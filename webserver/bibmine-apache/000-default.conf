<VirtualHost *:80>
	ServerName [BASE-URL]

	Redirect permanent /auth/ https://[BASE-URL]/auth/

</VirtualHost>

<VirtualHost *:443>
	ServerAdmin [ADMIN-EMAIL]
	ServerName [BASE-URL]
	ServerAlias [BASE-URL]

	DocumentRoot /var/www

	ProxyPreserveHost On
	ProxyRequests Off

	SSLEngine on
	SSLCertificateFile /etc/letsencrypt/live/[BASE-URL]/cert.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/[BASE-URL]/privkey.pem
	Include /etc/letsencrypt/options-ssl-apache.conf
	SSLCertificateChainFile /etc/letsencrypt/live/[BASE-URL]/chain.pem

	SSLProxyEngine On
	SSLProxyCheckPeerCN on
	SSLProxyCheckPeerExpire on
	RequestHeader set X-Forwarded-Proto "https"
	RequestHeader set X-Forwarded-Port "443"

	ProxyPass /auth http://localhost:8080/auth
	ProxyPassReverse /auth http://localhost:8080/auth

	ProxyPass /api http://localhost:3000/api
	ProxyPassReverse /api http://localhost:3000/api

	ProxyPass / !
	RedirectMatch ^/$ https://[BASE-URL]/

	<Location />
		Options FollowSymLinks
		AllowOverride None
		Require all granted
	</Location>

#	SSL Debugging
#	<IfModule mod_ssl.c>
#		ErrorLog /var/log/apache2/ssl_engine.log
#		LogLevel debug
#	</IfModule>
</VirtualHost>
